Added a test to account for array valued k and theta
